\chapter{Introduction}\label{chap:introduction}

\section{Model-Driven Development in Education at NTNU}
% * NTNU, TDT4250, EMF in education, Eclipse IDE for EMF, shift from Eclipse to web with Theia/VSCode

\paragraph{In a world that becomes more digital for each day, there is a large need for software development.} Software is often created by writing code using programming languages that compile down to computer instructions. Developers write the code based on a set of requirements, and change it when the  requirements change.

\paragraph{One alternative approach to software development, is \acrfull{MDD}.}
This approach has the developers create models of their \gls{domain}, and this model drives the rest of the software development. 
The code is usually generated from the model. 
If the software requirements change, the model is updated first, and the code is re-generated.
The model itself is often one or more artifacts in the software project, expressed in a modeling language.
Modeling simplifies the \gls{domain} by using abstraction, and reduces the world down to the entities, relations, procedures (or other abstractions) that are needed to solve the relevant problems.


\paragraph{The \acrshort{MDD} approach is taught at \acrfull{NTNU}.}
The course is named \textit{\gls{TDT4250} Advanced Software Design}.
A modeling language called \textit{\gls{Ecore}} is used in \gls{TDT4250}.
This language comes from the \acrfull{EMF}.
The models can generate java code, and can extend the \gls{Eclipse} as a plugin.
The plugin lets a user enter data for a model instance by using \gls{Eclipse} as a user interface.
Students also learn to create \acrfullpl{DSL} with an \gls{Ecore} model as its core.

\paragraph{\Gls{Eclipse} is required to work with \acrshort{EMF} modeling.}
It has editors for \gls{Ecore}, code generation and model validation.
There are two main types of editors: hierarchical tree editors and graphical diagram editors.
There are also multiple different implementation on the tree editors, based on different underlying frameworks.

\paragraph{The reliance on \gls{Eclipse} is a problem for students.}
Students don't like to work in Eclipse, because of various issues with usability, errors or stability. %TODO: cite?
If a student wants to use \acrshort{EMF} afterwards in their job, they would have to use \gls{Eclipse}, and also convince their team to do it as well.
Some students see \acrshort{EMF} as being too \gls{Eclipse} related, as well, and incorrectly see it as a tool for only developing Eclipse plugins.
This results in students resisting to learn \acrshort{EMF}, and also \acrshort{MDD} by implication, because no \acrshort{EMF} alternative is taught.

\paragraph{\acrshort{NTNU} wants to move from \gls{Eclipse} to \gls{VSCode} running in a web browser.}
This is a recent decision, and mainly for the course in Object Oriented Programming with java.
Some of the reasoning behind the change, is to avoid installation issues from \gls{Eclipse}, and to ease online collaboration through GitHub and publication of assignments. %TODO: cite?
\gls{VSCode} is an advanced text editor that has increased in popularity in the recent years.
It is based on web technologies, but normally runs as a desktop application.
A website and service called \textit{\gls{Gitpod}} allows running \gls{VSCode} in a web browser, and connect it to a workspace based on a GitHub repository.
The workspace has the project files, software development kits and other tools already installed and running in a remote machine in the \gls{cloud}.
This avoids all installation on a student's machine.

\paragraph{For \gls{TDT4250} to follow suit and move to \gls{Gitpod}, the \gls{Ecore} editors would have to be available in \gls{VSCode} as well.}
The current situation is that there are no \gls{Ecore} editors for \gls{VSCode}.
There are also no known \acrshort{MDD} frameworks for \gls{VSCode} that integrates with the other curriculum of \gls{TDT4250} either, as alternatives to \acrshort{EMF}.


\section{The Eclipse Ecosystem Wants to Run Software in the Cloud}
%* Eclipse ecosystem is moving to the cloud, EMF.Cloud, GLSP, Theia, Gitpod, Sprotty.
%  * Pre-project identified that the main actors are TypeFox, EclipseSource, RedHat, Obeo
%  * Main focus on development, not the developer; code in Eclipse and run in cloud

\paragraph{The \acrlong{EMF} is powered by \gls{open source} software and an ecosystem of developers.}
The framework has many tools and software libraries available, contributed by various developers and organizations.
These developers and organizations, is what this thesis nicknames the \textit{Eclipse Ecosystem}.
Some prominent actors are the organizations \textit{TypeFox}, \textit{EclipseSource} (with Dr.\ Jonas Helming and Maximilian Koegel), \textit{Obeo} and \textit{RedHat}~\cite{rekstadModelingEnvironmentCloud2020}.
For example, \textit{\gls{Gitpod}} is developed by TypeFox, and one of the \gls{Eclipse} tree editors for \gls{Ecore} is created by EclipseSource~\cite{typefoxTypeFoxSmartTools,eclipsesourceEMFFormsEditors2016}.

\paragraph{\Gls{cloud} is becoming more popular, and the Eclipse Ecosystem is heading there.}
When something \textit{runs in the \gls{cloud}}, it really means that it runs on rented computers in a data center somewhere outside of the organization.
Running in the cloud is a win for developers and organizations, because they don't need to take care of their own hardware.
And scaling up to more computers is as easy as clicking a button, or often happens automatically with load balancing technology.
No more purchasing of hardware and configuring it.
When developers ``embrace'' the \gls{cloud}, it also means working more with web technologies and less with desktop applications.

\paragraph{To use \acrshort{EMF} in the cloud, the Eclipse ecosystem has started to create new tools.}
Most of the tools are related to \textbf{running} \acrshort{EMF}-based software, but not \textbf{developing} it.
There are \textit{some} advances to developing in the cloud, with \textit{Gitpod} and the \gls{VSCode} re-implementation \textit{\gls{Theia}}, but neither have tools for \acrshort{EMF}.


\section{A Pre-project Identified a Need for a Tree Editor}
% EclipseCon, GLSP, Ecore GLSP, Theia extension, Gitpod, 

\paragraph{This masters thesis is preceded by a pre-project thesis.}
This work happened during the Autumn of 2020, the semester before this masters thesis.
The results were presented in \cite{rekstadModelingEnvironmentCloud2020}.
The project began by identifying what to build.
The need for \acrshort{EMF} editing in the \gls{cloud} was known, but not how to do it or if it was even possible.

\paragraph{The pre-project identified a need for a web-based tree editor for working with \acrshort{EMF}.}
Early plans were to create a diagram editor, inspired by \textit{\gls{UML} Class Diagrams} and the \gls{Eclipse} diagram editor for \gls{Ecore} named \textit{Ecore Tools} (based on \textit{Sirius} by aforementioned Obeo)~\cite{rekstadModelingEnvironmentCloud2020}.
During an online conference for the Eclipse ecosystem, EclipseCon 2020, it became clear that EclipseSource was already working on this.
However, based on the author's experience as a former student of \gls{TDT4250}, most of the work with \gls{Ecore} happened in a tree structure\footnote{\textit{Tree structure} here means the hierarchical parent-child structure, perhaps better known from file system folders and file browsers.} editor with a property sheet.
This kind of editor has what is known as a \textit{master-detail layout}, where the tree is a master view, and the property sheet is the details of the current selection in the tree.
No actor in the Eclipse ecosystem was working on such a tree editor for \gls{Ecore} models for \gls{VSCode}.
Preliminary searches online did not find such an editor created by anyone outside the Eclipse ecosystem either.

% TODO: add a picture of a tree editor

\paragraph{Initial requirements for a tree editor were chosen.}
The period of work was constrained to the pre-project and master's thesis, which is from August 2020 to June 2021.
This constraint made it a goal to reduce the amount of unnecessary work and reduce re-implementation of existing solutions.
For example, the \acrlong{EMF} is big, with many years worth of experience ingrained in its implementation details.
Therefore, a non-functional requirement emerged: \textbf{the editor should re-use as much of the existing \acrshort{EMF} java code as possible.}


Another non-functional requirement was that \textbf{it should run inside \gls{VSCode} as an extension}.
Gitpod was at the time was using \gls{Theia} as the editor, which was compatible with \gls{VSCode} extensions~\cite{rekstadModelingEnvironmentCloud2020}.
\Gls{Theia} has two extension mechanisms, but only the \gls{VSCode} extension mechanism could be installed during runtime by students\cite{rekstadModelingEnvironmentCloud2020}.
Because a goal was to use the Gitpod service for \gls{TDT4250}, this compatibility was needed.


The third non-functional requirement was that \textbf{the project should be \gls{open source} and designed to live longer than the period of work.}
A goal is to include all or most of the functionality already present in \gls{Eclipse}, which was estimated to be more work than what was possible to do during the pre-project and master's thesis.
Therefore, the development will need to be taken over by someone else afterwards.
Either the Eclipse ecosystem, or a master's thesis by another student.
An \gls{open source} project needs some additional care if it wants to succeed.
For the Eclipse ecosystem to handle it, the software should have a compatible license, and not copy or use code with incompatible licenses.
The code should also be well structured, documented and easy to contribute to for others.


The initial, unrefined functional requirement was that \textbf{\gls{VSCode} should be able to view, edit and save \gls{Ecore} models and model instances in ``.ecore'' and ``.xmi'' files.}
The pre-project did further work to refine this functional requirement into multiple smaller requirements, and discovered many new ones, by requirements extraction~\cite[p.~47,48]{rekstadModelingEnvironmentCloud2020}.
As noted in the discussion in \cite[p.~51]{rekstadModelingEnvironmentCloud2020}, the list of functional requirements was not complete.
% TODO: add requirements as appendix?


\paragraph{A software architecture and protocol emerged by analyzing similar solutions.}
Because the \acrshort{EMF} tooling had to move to \gls{VSCode} now, it is plausible that it will need to move to another \acrshort{IDE} later in the future.
This could result in a customized plugin for each editor.
That problem is also seen in programming languages: every editor needs a plugin for every programming language.
Microsoft has tried to solve this combinatorial ``\(m{\times}n\)'' problem in \gls{VSCode} by introducing the \acrfull{LSP}.
This architecture was also used as inspiration for a Eclipse ecosystem project, the \acrfull{GLSP}.
A similar protocol design could benefit this tree editor, where the \gls{Ecore} language details are isolated in a component reusable across \acrshortpl{IDE}~\cite{rekstadModelingEnvironmentCloud2020}.


The architecture was also inspired by \acrshort{GLSP} in terms of components for the \gls{VSCode} extension.
A ``generic'' frontend that handles all kinds of tree structures is hosted in a webview inside \gls{VSCode}, and talks to the \gls{VSCode} extension.
The extension code bridges the \gls{Ecore} specific server to the generic frontend via the previously mentioned protocol~\cite{rekstadModelingEnvironmentCloud2020}.

% TODO: add figure of architecture?

\paragraph{The pre-project used prototypes to verify the feasibility of the architecture.}
The main issues solved in the pre-project were related to design choices and feasibility.
It tried to answer if and how such a \gls{Ecore} specific server could be made in java and be executed from the \gls{VSCode} extension itself.


\paragraph{More work was needed in order to evaluate the pre-project solution.}
% Not connected end-to-end. Not usable.

% Research objectives ?
%TODO

% Thesis structure ?
%TODO